# Activate a project environment using --dir and check an environment variable
# is set.

set dir [lindex $argv 0]
set flox $env(FLOX_BIN)

expect_before {
  timeout { exit 1 }
  eof { exit 2 }
  "*\n" { exp_continue }
}
spawn $flox activate --dir $dir
expect -ex "Building environment..." {}

# check for alias
send "echo \$foo\n"
expect -ex "baz"

send "exit\n"
expect eof

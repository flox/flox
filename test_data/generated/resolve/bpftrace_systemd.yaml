when:
  path: /api/v1/catalog/resolve
  method: POST
  body: '{"items":[{"descriptors":[{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["aarch64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["x86_64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["x86_64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["aarch64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["x86_64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["x86_64-linux"]}],"name":"toplevel"}]}'
then:
  status: 200
  header:
  - name: date
    value: Wed, 30 Jul 2025 17:01:20 GMT
  - name: content-type
    value: application/json
  - name: content-length
    value: '1796'
  - name: server
    value: uvicorn
  - name: apigw-requestid
    value: OiFrEirioAMEapQ=
  body: '{"items":[{"name":"toplevel","page":null,"candidate_pages":null,"messages":[{"level":"error","type":"attr_path_not_found.not_found_for_all_systems","message":"The attr_path bpftrace is not found for all the requested systems, suggest limiting systems to (aarch64-linux,x86_64-linux).","context":{"attr_path":"bpftrace","install_id":"bpftrace","valid_systems":"aarch64-linux,x86_64-linux"}},{"level":"error","type":"attr_path_not_found.not_found_for_all_systems","message":"The attr_path systemd is not found for all the requested systems, suggest limiting systems to (aarch64-linux,x86_64-linux).","context":{"attr_path":"systemd","install_id":"systemd","valid_systems":"aarch64-linux,x86_64-linux"}},{"level":"trace","type":"resolution_logic","message":"TRACE (GROUP): Group ''toplevel'' could not be resolved with strategy: Stage 1: Only allow missing builds for packages without current locked derivations.","context":{"install_id":"GROUP","message":"Group ''toplevel'' could not be resolved with strategy: Stage 1: Only allow missing builds for packages without current locked derivations."}},{"level":"trace","type":"resolution_logic","message":"TRACE (GROUP): Group ''toplevel'' could not be resolved with strategy: Stage 2: Unlock existing derivations but require known builds.","context":{"install_id":"GROUP","message":"Group ''toplevel'' could not be resolved with strategy: Stage 2: Unlock existing derivations but require known builds."}},{"level":"trace","type":"resolution_logic","message":"TRACE (GROUP): Group ''toplevel'' could not be resolved with strategy: Stage 3: Unlock existing derivations and allow missing builds.","context":{"install_id":"GROUP","message":"Group ''toplevel'' could not be resolved with strategy: Stage 3: Unlock existing derivations and allow missing builds."}}]}]}'
---
when:
  path: /api/v1/catalog/resolve
  method: POST
  body: '{"items":[{"descriptors":[{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["x86_64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["x86_64-linux"]}],"name":"toplevel"}]}'
then:
  status: 200
  header:
  - name: date
    value: Wed, 30 Jul 2025 17:01:20 GMT
  - name: content-type
    value: application/json
  - name: content-length
    value: '4377'
  - name: server
    value: uvicorn
  - name: apigw-requestid
    value: OiFrKiO8IAMEaZw=
  body: '{"items":[{"name":"toplevel","page":{"page":836203,"url":"","packages":[{"catalog":"nixpkgs","attr_path":"bpftrace","pkg_path":"bpftrace","derivation":"/nix/store/a8h6zl43ai8y868hrh3kj67a56ympg8n-bpftrace-0.23.5.drv","name":"bpftrace-0.23.5","pname":"bpftrace","version":"0.23.5","system":"aarch64-linux","outputs":[{"name":"man","store_path":"/nix/store/xx30hcc4nggmalhds1b0ivnj5pp37b59-bpftrace-0.23.5-man"},{"name":"out","store_path":"/nix/store/wlyzh79cbfzxpcgc1gkxz0s7ypjzah7g-bpftrace-0.23.5"}],"outputs_to_install":["man","out"],"description":"High-level tracing language for Linux eBPF","license":"Apache-2.0","locked_url":"https://github.com/flox/nixpkgs?rev=dc9637876d0dcc8c9e5e22986b857632effeb727","rev":"dc9637876d0dcc8c9e5e22986b857632effeb727","rev_count":836203,"rev_date":"2025-07-28T09:26:29Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["unstable"],"scrape_date":"2025-07-30T00:47:40.353989Z","cache_uri":null,"install_id":"bpftrace"},{"catalog":"nixpkgs","attr_path":"bpftrace","pkg_path":"bpftrace","derivation":"/nix/store/ay94vykn09lg2yr48v0n5bag58ik0ii0-bpftrace-0.23.5.drv","name":"bpftrace-0.23.5","pname":"bpftrace","version":"0.23.5","system":"x86_64-linux","outputs":[{"name":"man","store_path":"/nix/store/d4k4wc3clzbsjzcibrkg3sla09z5x5kc-bpftrace-0.23.5-man"},{"name":"out","store_path":"/nix/store/8l2452aipdr35xg6iz18b4jpbiw2vbrw-bpftrace-0.23.5"}],"outputs_to_install":["man","out"],"description":"High-level tracing language for Linux eBPF","license":"Apache-2.0","locked_url":"https://github.com/flox/nixpkgs?rev=dc9637876d0dcc8c9e5e22986b857632effeb727","rev":"dc9637876d0dcc8c9e5e22986b857632effeb727","rev_count":836203,"rev_date":"2025-07-28T09:26:29Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["unstable"],"scrape_date":"2025-07-30T01:31:20.215918Z","cache_uri":null,"install_id":"bpftrace"},{"catalog":"nixpkgs","attr_path":"systemd","pkg_path":"systemd","derivation":"/nix/store/6rbammmdfd3wc2sn8filq91akx5pc60d-systemd-257.6.drv","name":"systemd-257.6","pname":"systemd","version":"257.6","system":"aarch64-linux","outputs":[{"name":"dev","store_path":"/nix/store/cx0xflq74l4qxmglm1cl6i9cmhbc4b9s-systemd-257.6-dev"},{"name":"man","store_path":"/nix/store/hc6s6p2pn0nibbqghw1bsahw7vdc31za-systemd-257.6-man"},{"name":"out","store_path":"/nix/store/jiz0bcmhjzxw2klink4w800yn2bf24pj-systemd-257.6"},{"name":"debug","store_path":"/nix/store/ivavw366vl44k6d928vixm6cxdahlccw-systemd-257.6-debug"}],"outputs_to_install":["man","out"],"description":"System and service manager for Linux","license":"[ BSD-2-Clause, BSD-3-Clause, CC0-1.0, LGPL-2.1-or-later, LGPL-2.0-or-later, MIT, MIT-0, OFL-1.1, Public Domain ]","locked_url":"https://github.com/flox/nixpkgs?rev=dc9637876d0dcc8c9e5e22986b857632effeb727","rev":"dc9637876d0dcc8c9e5e22986b857632effeb727","rev_count":836203,"rev_date":"2025-07-28T09:26:29Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["unstable"],"scrape_date":"2025-07-30T00:48:50.059297Z","cache_uri":null,"install_id":"systemd"},{"catalog":"nixpkgs","attr_path":"systemd","pkg_path":"systemd","derivation":"/nix/store/0fwkx6nibhcxsbjsakdjim6lyac5bp1s-systemd-257.6.drv","name":"systemd-257.6","pname":"systemd","version":"257.6","system":"x86_64-linux","outputs":[{"name":"dev","store_path":"/nix/store/pr4c8yawf04amw71dcy03sjpz8xvjy7x-systemd-257.6-dev"},{"name":"man","store_path":"/nix/store/2asr4m8bi9afd7y7ia5aflgsrh2y7mlk-systemd-257.6-man"},{"name":"out","store_path":"/nix/store/wq3ivni0plh7g8xl3my8qr9llh4dy7q4-systemd-257.6"},{"name":"debug","store_path":"/nix/store/bhwxi15p5j2bs56y0aqj64d6hfm2gdvc-systemd-257.6-debug"}],"outputs_to_install":["man","out"],"description":"System and service manager for Linux","license":"[ BSD-2-Clause, BSD-3-Clause, CC0-1.0, LGPL-2.1-or-later, LGPL-2.0-or-later, MIT, MIT-0, OFL-1.1, Public Domain ]","locked_url":"https://github.com/flox/nixpkgs?rev=dc9637876d0dcc8c9e5e22986b857632effeb727","rev":"dc9637876d0dcc8c9e5e22986b857632effeb727","rev_count":836203,"rev_date":"2025-07-28T09:26:29Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["unstable"],"scrape_date":"2025-07-30T01:32:35.234791Z","cache_uri":null,"install_id":"systemd"}],"messages":[],"complete":true},"candidate_pages":null,"messages":[]}]}'

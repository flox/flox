when:
  path: /api/v1/catalog/resolve
  method: POST
  body: '{"items":[{"descriptors":[{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["aarch64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["x86_64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["x86_64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["aarch64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["x86_64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["x86_64-linux"]}],"name":"toplevel"}]}'
then:
  status: 200
  header:
  - name: date
    value: Mon, 12 May 2025 14:55:02 GMT
  - name: content-type
    value: application/json
  - name: content-length
    value: '681'
  - name: server
    value: uvicorn
  - name: apigw-requestid
    value: KdbG-gN-IAMEa3g=
  body: '{"items":[{"name":"toplevel","page":null,"messages":[{"level":"error","type":"attr_path_not_found.not_found_for_all_systems","message":"The attr_path bpftrace is not found for all the requested systems, suggest limiting systems to (aarch64-linux,x86_64-linux).","context":{"attr_path":"bpftrace","install_id":"bpftrace","valid_systems":"aarch64-linux,x86_64-linux"}},{"level":"error","type":"attr_path_not_found.not_found_for_all_systems","message":"The attr_path systemd is not found for all the requested systems, suggest limiting systems to (aarch64-linux,x86_64-linux).","context":{"attr_path":"systemd","install_id":"systemd","valid_systems":"aarch64-linux,x86_64-linux"}}]}]}'
---
when:
  path: /api/v1/catalog/resolve
  method: POST
  body: '{"items":[{"descriptors":[{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"bpftrace","install_id":"bpftrace","systems":["x86_64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_missing_builds":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"systemd","install_id":"systemd","systems":["x86_64-linux"]}],"name":"toplevel"}]}'
then:
  status: 200
  header:
  - name: date
    value: Mon, 12 May 2025 14:55:03 GMT
  - name: content-type
    value: application/json
  - name: content-length
    value: '4394'
  - name: server
    value: uvicorn
  - name: apigw-requestid
    value: KdbHJjD8IAMESSQ=
  body: '{"items":[{"name":"toplevel","page":{"page":793735,"url":"","packages":[{"catalog":"nixpkgs","attr_path":"bpftrace","pkg_path":"bpftrace","derivation":"/nix/store/p0fcazk3vmfi1qcdm8k407vx2r0rq2pb-bpftrace-0.23.2.drv","name":"bpftrace-0.23.2","pname":"bpftrace","version":"0.23.2","system":"aarch64-linux","outputs":[{"name":"man","store_path":"/nix/store/zxq0wlxm1l9ypaln53avfgq5kncpcrfg-bpftrace-0.23.2-man"},{"name":"out","store_path":"/nix/store/a5bxkc8rhajdfq9qh7spk886y2w76m4i-bpftrace-0.23.2"}],"outputs_to_install":["man","out"],"description":"High-level tracing language for Linux eBPF","license":"Apache-2.0","locked_url":"https://github.com/flox/nixpkgs?rev=979daf34c8cacebcd917d540070b52a3c2b9b16e","rev":"979daf34c8cacebcd917d540070b52a3c2b9b16e","rev_count":793735,"rev_date":"2025-05-04T03:14:55Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["staging","unstable"],"scrape_date":"2025-05-05T04:37:19.344451Z","cache_uri":null,"install_id":"bpftrace"},{"catalog":"nixpkgs","attr_path":"bpftrace","pkg_path":"bpftrace","derivation":"/nix/store/6wc35f0m3ihyl5mrqnjmdwr8sk41zyqk-bpftrace-0.23.2.drv","name":"bpftrace-0.23.2","pname":"bpftrace","version":"0.23.2","system":"x86_64-linux","outputs":[{"name":"man","store_path":"/nix/store/msgbyrwpdwknv43jxqwyllrix4lhywj9-bpftrace-0.23.2-man"},{"name":"out","store_path":"/nix/store/dr1np6qhhmffydpv3zvw02fl0q1bjy1i-bpftrace-0.23.2"}],"outputs_to_install":["man","out"],"description":"High-level tracing language for Linux eBPF","license":"Apache-2.0","locked_url":"https://github.com/flox/nixpkgs?rev=979daf34c8cacebcd917d540070b52a3c2b9b16e","rev":"979daf34c8cacebcd917d540070b52a3c2b9b16e","rev_count":793735,"rev_date":"2025-05-04T03:14:55Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["staging","unstable"],"scrape_date":"2025-05-05T05:15:54.141810Z","cache_uri":null,"install_id":"bpftrace"},{"catalog":"nixpkgs","attr_path":"systemd","pkg_path":"systemd","derivation":"/nix/store/rz83dql57saxn6w4w6vibwmgwdpp8sm6-systemd-257.3.drv","name":"systemd-257.3","pname":"systemd","version":"257.3","system":"aarch64-linux","outputs":[{"name":"dev","store_path":"/nix/store/dpwcvz6yw2km47rzixj7yd35vfsjcisr-systemd-257.3-dev"},{"name":"man","store_path":"/nix/store/791s7chrk02dl86r9xbvj2h4v4d2vfkg-systemd-257.3-man"},{"name":"out","store_path":"/nix/store/x7v2n7qsxwdzc928av143slzmpvlw6mj-systemd-257.3"},{"name":"debug","store_path":"/nix/store/ksbpyvzii693y15gvj5r1k1kg6j1g16i-systemd-257.3-debug"}],"outputs_to_install":["man","out"],"description":"System and service manager for Linux","license":"[ BSD-2-Clause, BSD-3-Clause, CC0-1.0, LGPL-2.1-or-later, LGPL-2.0-or-later, MIT, MIT-0, OFL-1.1, Public Domain ]","locked_url":"https://github.com/flox/nixpkgs?rev=979daf34c8cacebcd917d540070b52a3c2b9b16e","rev":"979daf34c8cacebcd917d540070b52a3c2b9b16e","rev_count":793735,"rev_date":"2025-05-04T03:14:55Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["staging","unstable"],"scrape_date":"2025-05-05T04:38:31.686347Z","cache_uri":null,"install_id":"systemd"},{"catalog":"nixpkgs","attr_path":"systemd","pkg_path":"systemd","derivation":"/nix/store/822xs1sh76p00r1bmpd3r3fpl84nl366-systemd-257.3.drv","name":"systemd-257.3","pname":"systemd","version":"257.3","system":"x86_64-linux","outputs":[{"name":"dev","store_path":"/nix/store/0l65bs8p2jdd8a9czjl5z3i2d2xshgak-systemd-257.3-dev"},{"name":"man","store_path":"/nix/store/23ra1m0hjzb85hk50cpsd1vb4gprrw33-systemd-257.3-man"},{"name":"out","store_path":"/nix/store/dzh1b0f5x3jypzn78hmhl0p4q296z6z8-systemd-257.3"},{"name":"debug","store_path":"/nix/store/l07ibl7y483q73469pp9p69qhqpi5v18-systemd-257.3-debug"}],"outputs_to_install":["man","out"],"description":"System and service manager for Linux","license":"[ BSD-2-Clause, BSD-3-Clause, CC0-1.0, LGPL-2.1-or-later, LGPL-2.0-or-later, MIT, MIT-0, OFL-1.1, Public Domain ]","locked_url":"https://github.com/flox/nixpkgs?rev=979daf34c8cacebcd917d540070b52a3c2b9b16e","rev":"979daf34c8cacebcd917d540070b52a3c2b9b16e","rev_count":793735,"rev_date":"2025-05-04T03:14:55Z","broken":false,"insecure":false,"unfree":false,"missing_builds":false,"stabilities":["staging","unstable"],"scrape_date":"2025-05-05T05:17:12.350084Z","cache_uri":null,"install_id":"systemd"}],"messages":[],"complete":true},"messages":[]}]}'

when:
  path: /api/v1/catalog/resolve
  method: POST
  body: '{"items":[{"descriptors":[{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"hello-unfree","install_id":"hello-unfree","systems":["aarch64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"hello-unfree","install_id":"hello-unfree","systems":["aarch64-linux"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"hello-unfree","install_id":"hello-unfree","systems":["x86_64-darwin"]},{"allow_broken":null,"allow_insecure":null,"allow_pre_releases":null,"allow_unfree":null,"attr_path":"hello-unfree","install_id":"hello-unfree","systems":["x86_64-linux"]}],"name":"toplevel"}]}'
then:
  status: 200
  header:
  - name: date
    value: Fri, 07 Nov 2025 21:37:05 GMT
  - name: content-type
    value: application/json
  - name: content-length
    value: '3623'
  - name: server
    value: uvicorn
  - name: apigw-requestid
    value: TsT0Og1TIAMEVwg=
  body: '{"items":[{"name":"toplevel","page":{"page":888552,"url":"","packages":[{"catalog":"nixpkgs","attr_path":"hello-unfree","pkg_path":"hello-unfree","derivation":"/nix/store/bpw6bdmm07kcpybwzhi5ka5r76yzdidv-example-unfree-package-1.0.drv","name":"example-unfree-package-1.0","pname":"hello-unfree","version":"1.0","system":"aarch64-darwin","outputs":[{"name":"out","store_path":"/nix/store/nb85w1kk55qcf3ndvpyyrgrk9f4jw00c-example-unfree-package-1.0"}],"outputs_to_install":["out"],"description":"Example package with unfree license (for testing)","license":"Unfree","locked_url":"https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev":"b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev_count":888552,"rev_date":"2025-11-02T19:18:41Z","broken":false,"insecure":false,"unfree":true,"missing_builds":true,"stabilities":["unstable"],"scrape_date":"2025-11-04T00:35:31.907999Z","cache_uri":null,"install_id":"hello-unfree"},{"catalog":"nixpkgs","attr_path":"hello-unfree","pkg_path":"hello-unfree","derivation":"/nix/store/n77v9ap3s4fk9l5a2ncz2snrq7gsknkd-example-unfree-package-1.0.drv","name":"example-unfree-package-1.0","pname":"hello-unfree","version":"1.0","system":"aarch64-linux","outputs":[{"name":"out","store_path":"/nix/store/7wbpxf31qil4x1vavpizwcbnvgab40zi-example-unfree-package-1.0"}],"outputs_to_install":["out"],"description":"Example package with unfree license (for testing)","license":"Unfree","locked_url":"https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev":"b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev_count":888552,"rev_date":"2025-11-02T19:18:41Z","broken":false,"insecure":false,"unfree":true,"missing_builds":true,"stabilities":["unstable"],"scrape_date":"2025-11-05T16:29:15.126384Z","cache_uri":null,"install_id":"hello-unfree"},{"catalog":"nixpkgs","attr_path":"hello-unfree","pkg_path":"hello-unfree","derivation":"/nix/store/glcza1fcbbw2b2zm61fmy8r536s10glb-example-unfree-package-1.0.drv","name":"example-unfree-package-1.0","pname":"hello-unfree","version":"1.0","system":"x86_64-darwin","outputs":[{"name":"out","store_path":"/nix/store/6rda14aj4mj1n3hw32cwdlyfvxikdj9j-example-unfree-package-1.0"}],"outputs_to_install":["out"],"description":"Example package with unfree license (for testing)","license":"Unfree","locked_url":"https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev":"b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev_count":888552,"rev_date":"2025-11-02T19:18:41Z","broken":false,"insecure":false,"unfree":true,"missing_builds":true,"stabilities":["unstable"],"scrape_date":"2025-11-05T16:55:11.844670Z","cache_uri":null,"install_id":"hello-unfree"},{"catalog":"nixpkgs","attr_path":"hello-unfree","pkg_path":"hello-unfree","derivation":"/nix/store/bk7qyyq97wikilvinj5m27dnxydz0fyl-example-unfree-package-1.0.drv","name":"example-unfree-package-1.0","pname":"hello-unfree","version":"1.0","system":"x86_64-linux","outputs":[{"name":"out","store_path":"/nix/store/p53ajnzd6pz5dff3yzai3zpqjz1zzg6f-example-unfree-package-1.0"}],"outputs_to_install":["out"],"description":"Example package with unfree license (for testing)","license":"Unfree","locked_url":"https://github.com/flox/nixpkgs?rev=b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev":"b3d51a0365f6695e7dd5cdf3e180604530ed33b4","rev_count":888552,"rev_date":"2025-11-02T19:18:41Z","broken":false,"insecure":false,"unfree":true,"missing_builds":true,"stabilities":["unstable"],"scrape_date":"2025-11-05T17:21:05.605437Z","cache_uri":null,"install_id":"hello-unfree"}],"messages":[],"complete":true},"candidate_pages":null,"messages":[]}]}'
